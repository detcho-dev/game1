<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investor Game</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --success: #2ecc71;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #34495e;
            --gray: #95a5a6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .game-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            color: var(--secondary);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--secondary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .event-log {
            height: 300px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        .log-entry.success { color: var(--success); }
        .log-entry.warning { color: var(--warning); }
        .log-entry.error { color: var(--accent); }

        .offer-display {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .offer-text {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--light);
        }

        .offer-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .btn-primary { background: var(--secondary); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-warning { background: var(--warning); color: white; }
        .btn-danger { background: var(--accent); color: white; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .property-card {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .property-type {
            font-weight: bold;
            color: var(--secondary);
            margin-bottom: 5px;
        }

        .property-amount {
            font-size: 1.2rem;
            color: var(--success);
        }

        .login-container {
            max-width: 400px;
            margin: 100px auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--light);
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.2);
            color: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
        }

        .hidden {
            display: none;
        }

        .day-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--accent);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
        }

        .negotiation-panel {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .auction-panel {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .auction-input {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .auction-input input {
            flex: 1;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.2);
            color: white;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: var(--success);
            width: 0%;
            transition: width 0.3s ease;
        }

        .event-counter {
            text-align: center;
            margin: 10px 0;
            font-size: 0.9rem;
            color: var(--gray);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ’° Investor Game</h1>
        </div>

        <div id="loginScreen" class="login-container">
            <h2 style="text-align: center; margin-bottom: 20px;">Login / Register</h2>
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" class="form-control" placeholder="Enter username">
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" class="form-control" placeholder="Enter password">
            </div>
            <button id="loginBtn" class="btn btn-primary" style="width: 100%;">Login / Register</button>
        </div>

        <div id="gameScreen" class="hidden">
            <div class="day-indicator">Day: <span id="dayDisplay">1</span></div>
            
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="balance">$1000</div>
                    <div class="stat-label">Balance</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="income">$0</div>
                    <div class="stat-label">Daily Income</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="propertyCount">0</div>
                    <div class="stat-label">Properties</div>
                </div>
            </div>

            <div class="game-container">
                <div class="panel">
                    <h3>Market Events</h3>
                    <div class="event-counter">Events remaining: <span id="eventsRemaining">0</span></div>
                    <div class="progress-bar">
                        <div class="progress" id="eventProgress"></div>
                    </div>
                    
                    <div id="currentEvent" class="offer-display">
                        <div class="offer-text">Waiting for next event...</div>
                    </div>
                    
                    <div id="negotiationPanel" class="negotiation-panel hidden">
                        <h4>Negotiation</h4>
                        <p>Negotiated price: $<span id="negotiatedPrice">0</span></p>
                        <div class="offer-actions">
                            <button id="acceptNegotiation" class="btn btn-success">Accept</button>
                            <button id="rejectNegotiation" class="btn btn-danger">Reject</button>
                        </div>
                    </div>
                    
                    <div id="auctionPanel" class="auction-panel hidden">
                        <h4>Auction</h4>
                        <p>Current bid: $<span id="currentBid">0</span></p>
                        <div class="auction-input">
                            <input type="number" id="bidInput" placeholder="Enter your bid">
                            <button id="placeBid" class="btn btn-primary">Place Bid</button>
                        </div>
                        <div class="offer-actions">
                            <button id="skipAuction" class="btn btn-warning">Skip</button>
                        </div>
                    </div>

                    <div class="offer-actions">
                        <button id="buyBtn" class="btn btn-success">Buy</button>
                        <button id="negotiateBtn" class="btn btn-warning">Negotiate</button>
                        <button id="declineBtn" class="btn btn-danger">Decline</button>
                    </div>
                </div>

                <div class="panel">
                    <h3>Your Properties</h3>
                    <div id="propertiesList" class="properties-grid">
                        <!-- Properties will be added here dynamically -->
                    </div>
                    
                    <h3 style="margin-top: 20px;">Event Log</h3>
                    <div id="eventLog" class="event-log">
                        <!-- Log entries will be added here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let gameState = {
            username: '',
            balance: 1000,
            day: 1,
            properties: [],
            eventLog: [],
            currentEvent: null,
            events: [],
            currentEventIndex: 0,
            dailyIncome: 0
        };

        // Units mapping
        const units = {
            'land': 'plots',
            'property': 'units',
            'gold': 'grams',
            'factory': 'factories',
            'company': 'shares',
            'island': 'islands'
        };

        // DOM Elements
        const loginScreen = document.getElementById('loginScreen');
        const gameScreen = document.getElementById('gameScreen');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const loginBtn = document.getElementById('loginBtn');
        const balanceDisplay = document.getElementById('balance');
        const dayDisplay = document.getElementById('dayDisplay');
        const propertyCountDisplay = document.getElementById('propertyCount');
        const eventLogDisplay = document.getElementById('eventLog');
        const currentEventDisplay = document.getElementById('currentEvent');
        const propertiesList = document.getElementById('propertiesList');
        const buyBtn = document.getElementById('buyBtn');
        const negotiateBtn = document.getElementById('negotiateBtn');
        const declineBtn = document.getElementById('declineBtn');
        const acceptNegotiation = document.getElementById('acceptNegotiation');
        const rejectNegotiation = document.getElementById('rejectNegotiation');
        const negotiationPanel = document.getElementById('negotiationPanel');
        const auctionPanel = document.getElementById('auctionPanel');
        const bidInput = document.getElementById('bidInput');
        const placeBid = document.getElementById('placeBid');
        const skipAuction = document.getElementById('skipAuction');
        const currentBid = document.getElementById('currentBid');
        const eventsRemaining = document.getElementById('eventsRemaining');
        const eventProgress = document.getElementById('eventProgress');
        const incomeDisplay = document.getElementById('income');

        // Initialize game
        function initGame() {
            loadGame();
            if (gameState.username) {
                showGameScreen();
                startNewDay();
            }
        }

        // Load game state from localStorage
        function loadGame() {
            const saved = localStorage.getItem('investorGame');
            if (saved) {
                gameState = JSON.parse(saved);
            }
        }

        // Save game state to localStorage
        function saveGame() {
            localStorage.setItem('investorGame', JSON.stringify(gameState));
        }

        // Login function
        loginBtn.addEventListener('click', () => {
            const username = usernameInput.value.trim();
            const password = passwordInput.value;
            
            if (!username) {
                alert('Please enter a username');
                return;
            }

            // Load existing user or create new
            let users = JSON.parse(localStorage.getItem('investorUsers') || '{}');
            
            if (users[username]) {
                // Existing user
                if (users[username].password !== password) {
                    alert('Wrong password');
                    return;
                }
                gameState = users[username];
                gameState.username = username;
            } else {
                // New user
                gameState = {
                    username: username,
                    balance: 1000,
                    day: 1,
                    properties: [],
                    eventLog: [],
                    password: password
                };
                users[username] = gameState;
            }
            
            localStorage.setItem('investorUsers', JSON.stringify(users));
            saveGame();
            showGameScreen();
            startNewDay();
        });

        // Show game screen
        function showGameScreen() {
            loginScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
        }

        // Start a new day
        function startNewDay() {
            calculateDailyIncome();
            generateEvents();
            updateDisplay();
            processNextEvent();
        }

        // Calculate daily income
        function calculateDailyIncome() {
            const baseIncome = 100;
            const bonus = gameState.properties.length * 50;
            gameState.dailyIncome = baseIncome + bonus;
            gameState.balance += gameState.dailyIncome;
            addLog(`Daily income: $${gameState.dailyIncome} (Base $${baseIncome} + $${bonus} bonus)`, 'success');
        }

        // Generate daily events
        function generateEvents() {
            const eventCount = Math.floor(Math.random() * 4) + 2; // 2-5 events
            gameState.events = [];
            for (let i = 0; i < eventCount; i++) {
                gameState.events.push(generateRandomEvent());
            }
            gameState.currentEventIndex = 0;
            eventsRemaining.textContent = gameState.events.length;
            updateEventProgress();
        }

        // Generate random event
        function generateRandomEvent() {
            const eventType = ['offer', 'sell', 'auction'][Math.floor(Math.random() * 3)];
            
            switch(eventType) {
                case 'offer':
                    return generateOffer();
                case 'sell':
                    return { type: 'sell', ...generateSellOffer() };
                case 'auction':
                    return { type: 'auction', ...generateAuction() };
            }
        }

        // Generate offer
        function generateOffer() {
            const types = ['land', 'property', 'gold', 'factory', 'company', 'island'];
            const type = types[Math.floor(Math.random() * types.length)];
            
            let offer = { type: 'offer', subtype: type };
            
            switch(type) {
                case 'land':
                    offer.price = Math.floor(Math.random() * 401) + 100;
                    offer.description = `Land offer: Buy 1 plot for $${offer.price}`;
                    break;
                case 'property':
                    offer.price = Math.floor(Math.random() * 1501) + 500;
                    offer.description = `Property offer: Buy 1 unit for $${offer.price}`;
                    break;
                case 'gold':
                    offer.grams = Math.floor(Math.random() * 91) + 10;
                    offer.pricePerGram = Math.floor(Math.random() * 51) + 50;
                    offer.price = offer.grams * offer.pricePerGram;
                    offer.description = `Gold offer: ${offer.grams}g at $${offer.pricePerGram}/g for total $${offer.price}`;
                    break;
                case 'factory':
                    offer.capacity = Math.floor(Math.random() * 5) + 1;
                    offer.price = offer.capacity * (Math.floor(Math.random() * 4001) + 1000);
                    offer.description = `Factory offer: Buy factory with capacity ${offer.capacity} for $${offer.price}`;
                    break;
                case 'company':
                    offer.shares = Math.floor(Math.random() * 41) + 10;
                    offer.pricePerShare = Math.floor(Math.random() * 301) + 200;
                    offer.price = offer.shares * offer.pricePerShare;
                    offer.description = `Company offer: ${offer.shares} shares at $${offer.pricePerShare}/share for total $${offer.price}`;
                    break;
                case 'island':
                    const sizes = ['small', 'medium', 'large'];
                    offer.size = sizes[Math.floor(Math.random() * sizes.length)];
                    const multipliers = { 'small': 500, 'medium': 2000, 'large': 5000 };
                    offer.price = multipliers[offer.size] * (Math.floor(Math.random() * 3) + 1);
                    offer.description = `Island offer: Buy a ${offer.size} island for $${offer.price}`;
                    break;
            }
            
            return offer;
        }

        // Generate sell offer
        function generateSellOffer() {
            const types = ['land', 'property', 'gold', 'factory', 'company', 'island'];
            const type = types[Math.floor(Math.random() * types.length)];
            
            let offer = { subtype: type };
            
            switch(type) {
                case 'gold':
                    offer.amount = Math.floor(Math.random() * 91) + 10;
                    offer.pricePerGram = Math.floor(Math.random() * 81) + 40;
                    offer.totalPrice = offer.amount * offer.pricePerGram;
                    offer.description = `Gold sell: ${offer.amount}g at $${offer.pricePerGram}/g for total $${offer.totalPrice}`;
                    break;
                case 'company':
                    offer.amount = Math.floor(Math.random() * 41) + 10;
                    offer.pricePerShare = Math.floor(Math.random() * 251) + 150;
                    offer.totalPrice = offer.amount * offer.pricePerShare;
                    offer.description = `Company sell: ${offer.amount} shares at $${offer.pricePerShare}/share for total $${offer.totalPrice}`;
                    break;
                case 'factory':
                    offer.amount = Math.floor(Math.random() * 5) + 1;
                    offer.pricePerUnit = Math.floor(Math.random() * 1201) + 800;
                    offer.totalPrice = offer.amount * offer.pricePerUnit;
                    offer.description = `Factory sell: capacity ${offer.amount} at $${offer.pricePerUnit}/unit for total $${offer.totalPrice}`;
                    break;
                case 'island':
                    offer.amount = 1;
                    offer.totalPrice = Math.floor(Math.random() * 4001) + 1000;
                    offer.description = `Island sell: 1 island at $${offer.totalPrice} total`;
                    break;
                default:
                    offer.amount = 1;
                    offer.totalPrice = Math.floor(Math.random() * 321) + 80;
                    offer.description = `Buyer offers $${offer.totalPrice} for your 1 ${units[type]}`;
                    break;
            }
            
            return offer;
        }

        // Generate auction
        function generateAuction() {
            const types = ['land', 'property', 'gold', 'factory', 'company', 'island'];
            const type = types[Math.floor(Math.random() * types.length)];
            
            const startPrice = type === 'gold' || type === 'factory' 
                ? Math.floor(Math.random() * 81) + 20 
                : Math.floor(Math.random() * 201) + 100;
            
            return {
                subtype: type,
                startPrice: startPrice,
                description: `Auction for ${type} starts at $${startPrice}`
            };
        }

        // Process next event
        function processNextEvent() {
            if (gameState.currentEventIndex >= gameState.events.length) {
                // Day complete
                gameState.day++;
                addLog('Day complete! Starting new day...', 'success');
                setTimeout(startNewDay, 2000);
                return;
            }

            gameState.currentEvent = gameState.events[gameState.currentEventIndex];
            displayCurrentEvent();
            eventsRemaining.textContent = gameState.events.length - gameState.currentEventIndex;
            updateEventProgress();
        }

        // Display current event
        function displayCurrentEvent() {
            const event = gameState.currentEvent;
            
            if (event.type === 'offer') {
                currentEventDisplay.innerHTML = `<div class="offer-text">${event.description}</div>`;
                negotiationPanel.classList.add('hidden');
                auctionPanel.classList.add('hidden');
            } else if (event.type === 'sell') {
                currentEventDisplay.innerHTML = `<div class="offer-text">${event.description}</div>`;
                negotiationPanel.classList.add('hidden');
                auctionPanel.classList.add('hidden');
            } else if (event.type === 'auction') {
                currentEventDisplay.innerHTML = `<div class="offer-text">${event.description}</div>`;
                currentBid.textContent = event.startPrice;
                bidInput.value = '';
                negotiationPanel.classList.add('hidden');
                auctionPanel.classList.remove('hidden');
            }
        }

        // Update event progress bar
        function updateEventProgress() {
            const progress = ((gameState.currentEventIndex) / gameState.events.length) * 100;
            eventProgress.style.width = `${progress}%`;
        }

        // Buy action
        buyBtn.addEventListener('click', () => {
            if (!gameState.currentEvent || gameState.currentEvent.type !== 'offer') return;
            
            const event = gameState.currentEvent;
            if (gameState.balance >= event.price) {
                gameState.balance -= event.price;
                
                // Add to properties
                const existingProperty = gameState.properties.find(p => p.type === event.subtype);
                if (existingProperty) {
                    if (event.subtype === 'gold') {
                        existingProperty.grams += event.grams || 0;
                    } else if (event.subtype === 'company') {
                        existingProperty.shares += event.shares || 0;
                    } else if (event.subtype === 'factory') {
                        existingProperty.capacity += event.capacity || 0;
                    } else {
                        existingProperty.quantity = (existingProperty.quantity || 0) + 1;
                    }
                    existingProperty.spent += event.price;
                } else {
                    const property = {
                        type: event.subtype,
                        spent: event.price
                    };
                    if (event.subtype === 'gold') property.grams = event.grams;
                    else if (event.subtype === 'company') property.shares = event.shares;
                    else if (event.subtype === 'factory') property.capacity = event.capacity;
                    else property.quantity = 1;
                    
                    gameState.properties.push(property);
                }
                
                addLog(`Bought ${event.subtype} for $${event.price}`, 'success');
                gameState.currentEventIndex++;
                saveGame();
                updateDisplay();
                setTimeout(processNextEvent, 1500);
            } else {
                addLog('Not enough balance to buy!', 'error');
            }
        });

        // Negotiate action
        negotiateBtn.addEventListener('click', () => {
            if (!gameState.currentEvent || gameState.currentEvent.type !== 'offer') return;
            
            const event = gameState.currentEvent;
            const discount = Math.floor(Math.random() * 26) + 5; // 5-30%
            const negotiatedPrice = Math.round(event.price * (1 - discount / 100));
            
            document.getElementById('negotiatedPrice').textContent = negotiatedPrice;
            negotiationPanel.classList.remove('hidden');
        });

        // Accept negotiation
        acceptNegotiation.addEventListener('click', () => {
            const event = gameState.currentEvent;
            const discount = Math.floor(Math.random() * 26) + 5; // 5-30%
            const negotiatedPrice = Math.round(event.price * (1 - discount / 100));
            
            if (gameState.balance >= negotiatedPrice) {
                gameState.balance -= negotiatedPrice;
                
                // Add to properties (same logic as buy)
                const existingProperty = gameState.properties.find(p => p.type === event.subtype);
                if (existingProperty) {
                    if (event.subtype === 'gold') {
                        existingProperty.grams += event.grams || 0;
                    } else if (event.subtype === 'company') {
                        existingProperty.shares += event.shares || 0;
                    } else if (event.subtype === 'factory') {
                        existingProperty.capacity += event.capacity || 0;
                    } else {
                        existingProperty.quantity = (existingProperty.quantity || 0) + 1;
                    }
                    existingProperty.spent += negotiatedPrice;
                } else {
                    const property = {
                        type: event.subtype,
                        spent: negotiatedPrice
                    };
                    if (event.subtype === 'gold') property.grams = event.grams;
                    else if (event.subtype === 'company') property.shares = event.shares;
                    else if (event.subtype === 'factory') property.capacity = event.capacity;
                    else property.quantity = 1;
                    
                    gameState.properties.push(property);
                }
                
                addLog(`Bought ${event.subtype} for $${negotiatedPrice} (negotiated from $${event.price})`, 'success');
                gameState.currentEventIndex++;
                saveGame();
                updateDisplay();
                negotiationPanel.classList.add('hidden');
                setTimeout(processNextEvent, 1500);
            } else {
                addLog('Not enough balance after negotiation!', 'error');
                negotiationPanel.classList.add('hidden');
            }
        });

        // Reject negotiation
        rejectNegotiation.addEventListener('click', () => {
            negotiationPanel.classList.add('hidden');
        });

        // Decline action
        declineBtn.addEventListener('click', () => {
            if (!gameState.currentEvent) return;
            addLog('Offer declined', 'warning');
            gameState.currentEventIndex++;
            saveGame();
            setTimeout(processNextEvent, 1500);
        });

        // Place bid in auction
        placeBid.addEventListener('click', () => {
            const bid = parseInt(bidInput.value);
            const event = gameState.currentEvent;
            
            if (isNaN(bid) || bid < event.startPrice) {
                addLog('Invalid bid amount!', 'error');
                return;
            }
            
            if (bid > gameState.balance) {
                addLog('Not enough balance for bid!', 'error');
                return;
            }
            
            gameState.balance -= bid;
            
            // Add property
            const property = {
                type: event.subtype,
                spent: bid
            };
            
            if (event.subtype === 'gold') property.grams = Math.floor(Math.random() * 91) + 10;
            else if (event.subtype === 'company') property.shares = Math.floor(Math.random() * 41) + 10;
            else if (event.subtype === 'factory') property.capacity = Math.floor(Math.random() * 5) + 1;
            else property.quantity = 1;
            
            gameState.properties.push(property);
            addLog(`Won auction for ${event.subtype} with bid $${bid}`, 'success');
            
            gameState.currentEventIndex++;
            saveGame();
            updateDisplay();
            auctionPanel.classList.add('hidden');
            setTimeout(processNextEvent, 1500);
        });

        // Skip auction
        skipAuction.addEventListener('click', () => {
            addLog('Auction skipped', 'warning');
            gameState.currentEventIndex++;
            saveGame();
            auctionPanel.classList.add('hidden');
            setTimeout(processNextEvent, 1500);
        });

        // Add log entry
        function addLog(message, type = 'info') {
            gameState.eventLog.push({ message, type, timestamp: new Date() });
            if (gameState.eventLog.length > 50) {
                gameState.eventLog.shift(); // Keep only last 50 entries
            }
            updateLogDisplay();
        }

        // Update log display
        function updateLogDisplay() {
            eventLogDisplay.innerHTML = '';
            gameState.eventLog.slice().reverse().forEach(entry => {
                const div = document.createElement('div');
                div.className = `log-entry ${entry.type}`;
                div.textContent = entry.message;
                eventLogDisplay.appendChild(div);
            });
        }

        // Update display
        function updateDisplay() {
            balanceDisplay.textContent = `$${gameState.balance}`;
            dayDisplay.textContent = gameState.day;
            propertyCountDisplay.textContent = gameState.properties.length;
            incomeDisplay.textContent = `$${gameState.dailyIncome}`;
            updatePropertiesDisplay();
            updateLogDisplay();
        }

        // Update properties display
        function updatePropertiesDisplay() {
            propertiesList.innerHTML = '';
            gameState.properties.forEach(property => {
                const div = document.createElement('div');
                div.className = 'property-card';
                
                let amount = 0;
                if (property.type === 'gold') amount = property.grams;
                else if (property.type === 'company') amount = property.shares;
                else if (property.type === 'factory') amount = property.capacity;
                else amount = property.quantity || 1;
                
                div.innerHTML = `
                    <div class="property-type">${property.type}</div>
                    <div class="property-amount">${amount} ${units[property.type]}</div>
                    <div style="font-size: 0.8rem; color: var(--gray);">Spent: $${property.spent}</div>
                `;
                propertiesList.appendChild(div);
            });
        }

        // Initialize the game
        window.onload = initGame;
    </script>
</body>
</html>
